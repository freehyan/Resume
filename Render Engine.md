
## 渲染引擎

### 基本概念

* 渲染引擎： 游戏引擎的核心，负责把三维图形绘制到屏幕，分为硬件渲染器和软件渲染器。硬件渲染器是基于底层API构建，采用硬件光栅化方法进行渲染，
图形API与硬件进行通信，常用的API包括OpenGL和DirectX。 软件渲染器纯利用CPU进行计算，通常采用光线追踪的方法进行渲染。


* 插件式结构: 
	* 插件: 组件是行为不一样的模块, 而相同行为规范的组件为插件，插件都共同实现相同的接口类;
	* 优势： 具有良好的可扩充性，可定制性，可维护性。
	* 增强代码一致性： 清晰一致的接口面对不同的图形语言;
	* 更换和增加组件: 方便容易地使用新的图形渲染器来构建图形特效;、

### 项目背景
* 面对问题: 更换图形语言，框架代码中依赖于外部库的代码需要重写;
* 解决方案: 工程中任何组件不依赖于具体图形API，GraphicsKernel从框架代码剥离出来，通过特定方法被放入动态链接库。 框架代码暴露接口，图形层具体实现。


### 引擎架构

* AbstractKernel: 组织整个引擎的渲染流程，从资源的创建与初始化，到游戏场景图的组织，以及最后游戏逻辑的渲染处理。 其特点不依赖于特定图形渲染语言，
暴露借口给图形层，让其可以为不同图形Kernel复用;

* OSGKernel: OSG也是上层的图形渲染引擎，使用OSG封装成OSGKernel，调用AbstractKernel暴露的接口完成图形渲染的具体实现；

* OpenGLKernel: OpenGL是更加基于硬件的图形API，相比OSG依赖于多一些的第三方库，不过也是完成AbstractKernel暴露的接口实现，完成图形的渲染的逻辑。


### 功能模块

* 文件系统模块
	* 日志模块
	* 配置文件
* 资源管理模块
	* 资源管理器
* 场景图模块
	* 模型变换
	* 场景组织
* 绘制管线模块
	* Pass
	* Shader
	* Uniform
* 相机模块
* ...

### 渲染流程

* 初始化图形引擎
	* 解析配置文件
	* 创建窗口
	* 初始化场景主相机
	* 创建资源管理器
	* 初始化渲染组件
	* 初始化场景和构建场景图
	* 设定外部IO输入事件
	* 初始化渲染管线流程

* 游戏渲染逻辑循环
	* 引擎事件预处理
	* 回调函数预处理
	* 引擎调用上层渲染接口
	* 引擎后处理
	* 回调函数的后处理
	* 判断终止渲染死循环逻辑

###  设计亮点


### 遇到问题